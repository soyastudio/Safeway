{
  "bod": {
    "name": "yext-store-hours"
  },
  "sourceTable": {
    "schema": "RDS_SRCYEXT",
    "table": "storehours",
    "columns": [
      "storeid",
      "latitude",
      "longitude",
      "hours",
      "holidayhours",
      "store_url"
    ],
    "primaryKey": "storeid",
    "insert": "INSERT INTO RDS_SRCYEXT.storehours (storeid, latitude, longitude, hours, holidayhours, store_url, last_updt_ts, process_ind) VALUES (:storeid, :latitude, :longitude, :hours, :holidayhours, :store_url, CURRENT_TIMESTAMP, 'N')",
    "update": "UPDATE RDS_SRCYEXT.storehours SET latitude = :latitude, longitude = :longitude, hours = :hours, holidayhours = :holidayhours, store_url = :store_url, last_updt_ts = CURRENT_TIMESTAMP, process_ind = 'N' WHERE pstoreid = :pstoreid"
  },
  "api": {
    "type": "paginate(OFFSET, 50, 75)",
    "url": "http://liveapi.yext.com/v2/accounts/me/locations?fields=id,yextDisplayLat,yextDisplayLng,hours,holidayHours,custom16236&api_key=6b8751105c4d898887200455f653d101&v=20191031&limit=50&offset={{OFFSET}}",
    "filter": "$.response.locations.[?(@.id=~/[0-9]{1,4}/)]",
    "shifters": [
      {
        "type": "String",
        "from": "id",
        "to": "storeid",
        "expression": "fill_left(4, 0)"
      },
      {
        "type": "Number",
        "from": "yextDisplayLat",
        "to": "latitude"
      },
      {
        "type": "Number",
        "from": "yextDisplayLng",
        "to": "longitude"
      },
      {
        "type": "String",
        "from": "hours",
        "to": "hours"
      },
      {
        "type": "String",
        "from": "holidayHours",
        "to": "holidayhours",
        "expression": "from_json()"
      },
      {
        "type": "String",
        "from": "customFields",
        "to": "store_url",
        "expression": "jsonpath($.16236)"
      }
    ]
  }
}